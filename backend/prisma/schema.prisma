datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model Division {
  id     String   @id @default(uuid())
  name   String
  slug   String   @unique
  admins Admin[]

  createdAt        DateTime       @default(now())
  updatedAt        DateTime       @updatedAt
}

model Admin {
  id         String   @id @default(uuid())
  email      String   @unique
  name       String
  division   Division @relation(fields: [divisionId], references: [id])
  divisionId String
  users      User[]
  
  createdAt        DateTime       @default(now())
  updatedAt        DateTime       @updatedAt
}

enum UserType {
  INTERNAL
  EXTERNAL
}

enum Category {
  INTERMEDIATE
  ADVANCED
}

model User {
  id               String     @id @default(uuid())
  email            String     @unique
  name             String
  type             UserType   @default(EXTERNAL)
  category         Category?   @default(INTERMEDIATE)
  age              Int?
  whatsapp         String?
  proofOfPayment   String?
  valid            Boolean?    @default(false)
  Admin            Admin?      @relation(fields: [adminId], references: [id])
  adminId          String?

  internalProfile  Internal?  @relation("UserInternal")
  externalProfile  External?  @relation("UserExternal")

  createdAt        DateTime   @default(now())
  updatedAt        DateTime   @updatedAt
}

model Internal {
  userId  String   @id
  nrp     String?   @unique
  batch   Int?
  major   String?
  ktm     String?

  user    User     @relation("UserInternal", fields: [userId], references: [id])
}

model External {
  userId   String   @id
  instance String?
  idCard   String?

  user     User     @relation("UserExternal", fields: [userId], references: [id])
}

enum AsalType {
  Petra
  Umum
}

model Talkshow {
  id                String    @id @default(uuid())
  asal              AsalType
  nama              String
  email             String    
  wa                String
  idline            String
  domisili          String?   // Nullable
  nrp               String?   // Nullable
  jurusan           String?   // Nullable
  proofOfPayment    String
  status_pembayaran Boolean   @default(false) // 0 = belum bayar
  created_at        DateTime  @default(now())
  updated_at        DateTime  @updatedAt
}

model Workshop {
  id                String    @id @default(uuid())
  asal              AsalType
  nama              String
  email             String    
  wa                String
  idline            String
  domisili          String?   // Nullable
  nrp               String?   // Nullable
  jurusan           String?   // Nullable
  proofOfPayment    String
  status_pembayaran Boolean   @default(false) // 0 = belum bayar
  created_at        DateTime  @default(now())
  updated_at        DateTime  @updatedAt
}

